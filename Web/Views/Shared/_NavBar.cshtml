@using System.Security.Claims
@{
	var isAuthenticated = User?.Identity != null && User.Identity.IsAuthenticated;
	var userName = User?.Identity?.Name ?? "";
	var userRole = User?.FindFirstValue(ClaimTypes.Role) ?? "";
}
<nav x-data="{ mobileMenuIsOpen: false }"
	 x-on:click.away="mobileMenuIsOpen = false"
	 class="flex items-center justify-between bg-surface-alt border-b border-outline px-6 py-4 dark:border-outline-dark dark:bg-surface-dark-alt"
	 aria-label="ui menu">
	<!-- Brand Logo -->
	<a href="/" class="text-2xl font-bold text-on-surface-strong dark:text-on-surface-dark-strong">
		<span>
			Library<span class="text-primary dark:text-primary-dark">Sys</span>
		</span>
		<!-- <img src="./your-logo.svg" alt="brand logo" class="w-10" /> -->
	</a>
	<!-- Desktop Menu -->
	<ul class="hidden items-center gap-4 sm:flex">
		<li>
			<a class="font-medium text-on-surface underline-offset-2 hover:text-primary focus:outline-hidden focus:underline dark:text-on-surface-dark dark:hover:text-primary-dark"
			   asp-area="" asp-controller="Home" asp-action="Index">
				Home
			</a>
		</li>
		<li>
			<a class="font-medium text-on-surface underline-offset-2 hover:text-primary focus:outline-hidden focus:underline dark:text-on-surface-dark dark:hover:text-primary-dark"
			   asp-area="" asp-controller="Book" asp-action="Index">
				Books
			</a>
		</li>
		<li>
			<a class="font-medium text-on-surface underline-offset-2 hover:text-primary focus:outline-hidden focus:underline dark:text-on-surface-dark dark:hover:text-primary-dark"
			   asp-area="" asp-controller="Category" asp-action="Index">
				Categories
			</a>
		</li>
		@if (isAuthenticated && (userRole == "Admin" || userRole == "Librarian"))
		{
			<li>
				<a class="font-medium text-on-surface underline-offset-2 hover:text-primary focus:outline-hidden focus:underline dark:text-on-surface-dark dark:hover:text-primary-dark"
				   asp-area="" asp-controller="User" asp-action="Index">
					Users
				</a>
			</li>
		}
		<li>
			<a class="font-medium text-on-surface underline-offset-2 hover:text-primary focus:outline-hidden focus:underline dark:text-on-surface-dark dark:hover:text-primary-dark"
			   asp-area="" asp-controller="Home" asp-action="Privacy">
				Privacy
			</a>
		</li>
		@if (!isAuthenticated)
		{
			<li>
				<a class="font-medium text-on-surface underline-offset-2 hover:text-primary focus:outline-hidden focus:underline dark:text-on-surface-dark dark:hover:text-primary-dark"
				   asp-area="" asp-controller="Account" asp-action="Login">
					Sign In
				</a>
			</li>
			<li>
				<a class="rounded-radius bg-primary border border-primary px-4 py-2 text-center text-sm font-medium tracking-wide text-on-primary hover:opacity-75 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary active:opacity-100 active:outline-offset-0 dark:bg-primary-dark dark:border-primary-dark dark:text-on-primary-dark dark:focus-visible:outline-primary-dark"
				   asp-area="" asp-controller="Account" asp-action="Register">
					Sign Up
				</a>
			</li>
		}
		else
		{
			<li>
				<a class="font-medium text-on-surface underline-offset-2 hover:text-primary focus:outline-hidden focus:underline dark:text-on-surface-dark dark:hover:text-primary-dark"
				   asp-area="" asp-controller="Profile" asp-action="Index">
					Profile
				</a>
			</li>
			<li>
				<form asp-area="" asp-controller="Account" asp-action="Logout" method="post" class="inline">
					<button type="submit" class="font-medium text-on-surface underline-offset-2 hover:text-primary focus:outline-hidden focus:underline dark:text-on-surface-dark dark:hover:text-primary-dark bg-transparent border-none cursor-pointer">Logout</button>
				</form>
			</li>
		}
	</ul>
	<!-- Mobile Menu Button -->
	<button x-on:click="mobileMenuIsOpen = !mobileMenuIsOpen"
			x-bind:aria-expanded="mobileMenuIsOpen"
			x-bind:class="mobileMenuIsOpen ? 'fixed top-6 right-6 z-20' : null"
			type="button"
			class="flex text-on-surface dark:text-on-surface-dark sm:hidden"
			aria-label="mobile menu"
			aria-controls="mobileMenu">
		<svg x-cloak x-show="!mobileMenuIsOpen" xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-6">
			<path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
		</svg>
		<svg x-cloak x-show="mobileMenuIsOpen" xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-6">
			<path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
		</svg>
	</button>
	<!-- Mobile Menu -->
	<ul x-cloak
		x-show="mobileMenuIsOpen"
		x-transition:enter="transition motion-reduce:transition-none ease-out duration-300"
		x-transition:enter-start="-translate-y-full"
		x-transition:enter-end="translate-y-0"
		x-transition:leave="transition motion-reduce:transition-none ease-out duration-300"
		x-transition:leave-start="translate-y-0"
		x-transition:leave-end="-translate-y-full"
		id="mobileMenu"
		class="fixed max-h-svh overflow-y-auto inset-x-0 top-0 z-10 flex flex-col divide-y divide-outline rounded-b-radius border-b border-outline bg-surface-alt px-6 pb-6 pt-20 dark:divide-outline-dark dark:border-outline-dark dark:bg-surface-dark-alt sm:hidden">
		<li class="py-4">
			<a class="w-full text-lg font-medium text-on-surface focus:underline dark:text-on-surface-dark"
			   asp-area="" asp-controller="Home" asp-action="Index">
				Home
			</a>
		</li>
		<li class="py-4">
			<a class="w-full text-lg font-medium text-on-surface focus:underline dark:text-on-surface-dark"
			   asp-area="" asp-controller="Book" asp-action="Index">
				Books
			</a>
		</li>
		<li class="py-4">
			<a class="w-full text-lg font-medium text-on-surface focus:underline dark:text-on-surface-dark"
			   asp-area="" asp-controller="Category" asp-action="Index">
				Categories
			</a>
		</li>
		@if (isAuthenticated && (userRole == "Admin" || userRole == "Librarian"))
		{
			<li class="py-4">
				<a class="w-full text-lg font-medium text-on-surface focus:underline dark:text-on-surface-dark"
				   asp-area="" asp-controller="User" asp-action="Index">
					Users
				</a>
			</li>
		}
		<li class="py-4">
			<a class="w-full text-lg font-medium text-on-surface focus:underline dark:text-on-surface-dark"
			   asp-area="" asp-controller="Home" asp-action="Privacy">
				Privacy
			</a>
		</li>
		@if (!isAuthenticated)
		{
			<li class="py-4">
				<a class="w-full text-lg font-medium text-on-surface focus:underline dark:text-on-surface-dark"
				   asp-area="" asp-controller="Account" asp-action="Login">
					Sign In
				</a>
			</li>
			<li class="mt-4 w-full border-none">
				<a class="rounded-radius border border-primary bg-primary px-4 py-2 block text-center font-medium tracking-wide text-on-primary hover:opacity-75 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary active:opacity-100 active:outline-offset-0 dark:bg-primary-dark dark:border-primary-dark dark:text-on-primary-dark dark:focus-visible:outline-primary-dark"
				   asp-area="" asp-controller="Account" asp-action="Register">Sign Up</a>
			</li>
		}
		else
		{
			<li class="py-4">
				<a class="w-full text-lg font-medium text-on-surface focus:underline dark:text-on-surface-dark"
				   asp-area="" asp-controller="Profile" asp-action="Index">
					Profile
				</a>
			</li>
			<li class="py-4">
				<form asp-area="" asp-controller="Account" asp-action="Logout" method="post" class="inline">
					<button type="submit" class="w-full text-lg font-medium text-on-surface focus:underline dark:text-on-surface-dark bg-transparent border-none cursor-pointer">Logout</button>
				</form>
			</li>
		}
	</ul>
</nav>